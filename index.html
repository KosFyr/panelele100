<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyStudyPlan - Πανελλήνιες</title>
    <style>
        /* ... (το υπάρχον CSS παραμένει το ίδιο) ... */
    </style>
</head>
<body>
    <div class="container" id="app">
        <!-- Αρχικό Μενού -->
        <div id="home-screen">
            <h1>MyStudyPlan</h1>
            <button onclick="navigate('math')">Μαθηματικά</button>
            <button class="coming-soon-btn" onclick="navigate('aoth')">ΑΟΘ</button>
            <button class="coming-soon-btn" onclick="navigate('aepp')">ΑΕΠΠ</button>
            <button onclick="navigate('history')">Ιστορία</button>
            <button onclick="navigate('english')">Αγγλικά</button>
        </div>

        <!-- Μενού Μαθηματικών -->
        <div id="math-menu" style="display: none;">
            <h1>Μαθηματικά</h1>
            <button onclick="navigate('quiz-options')">Σωστό / Λάθος</button>
            <button class="coming-soon-btn" onclick="navigate('theorems')">Θεωρήματα</button>
            <button class="coming-soon-btn" onclick="navigate('proofs')">Αποδείξεις</button>
            <button onclick="navigate('home')">Επιστροφή</button>
        </div>

        <!-- Επιλογές Quiz -->
        <div id="quiz-options" style="display: none;">
            <h1>Σωστό / Λάθος</h1>
            <button onclick="startRandomQuiz()">Τεστ 10 Ερωτήσεων</button>
            <button onclick="navigate('units')">Τεστ ανά Ενότητα</button>
            <button onclick="navigate('math')">Επιστροφή</button>
        </div>

        <!-- Ενότητες -->
        <div id="units" style="display: none;">
            <h1>Ενότητες</h1>
            <button onclick="startUnitQuiz('functions')">Συναρτήσεις</button>
            <button onclick="startUnitQuiz('limits')">Όρια</button>
            <button onclick="startUnitQuiz('continuity')">Θεωρήματα Συνέχειας</button>
            <button onclick="startUnitQuiz('derivatives')">Παράγωγος</button>
            <button onclick="navigate('quiz-options')">Επιστροφή</button>
        </div>

        <!-- Coming Soon Σελίδα -->
        <div id="coming-soon" style="display: none;">
            <h1>Coming Soon</h1>
            <button onclick="navigate('home')">Επιστροφή</button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" style="display: none;">
            <h1 id="quiz-title">Σωστό / Λάθος</h1>
            <button id="back-btn" onclick="navigate('quiz-options')">Επιστροφή</button>
            <div id="timer">Χρόνος: 120 δευτ.</div>
            <div id="progress"></div>
            <div id="advertisements" style="display: none;"></div>
            <div id="instructions" style="display: none;">Επιλέξτε μία ή δύο απαντήσεις και πατήστε Υποβολή.</div>
            <p id="question"></p>
            <div id="answer-options"></div>
            <button id="submit-btn" style="display: none;" onclick="submitAnswer()">Υποβολή</button>
            <button id="next-btn" style="display: none;" onclick="nextQuestion()">Επόμενη Ερώτηση</button>
        </div>

        <!-- Ολοκλήρωση Quiz -->
        <div id="results-screen" style="display: none;">
            <h1>Αποτελέσματα</h1>
            <p id="score"></p>
            <p id="feedback"></p>
            <button onclick="navigate('quiz-options')">Παίξε Ξανά</button>
            <button onclick="navigate('home')">Επιστροφή στο Αρχικό Μενού</button>
        </div>

        <!-- Μενού Ιστορίας -->
        <div id="history-menu" style="display: none;">
            <h1>Ιστορία</h1>
            <button onclick="navigate('history-unit1')">Εισαγωγή Ενότητας 1</button>
            <button class="coming-soon-btn" onclick="navigate('coming-soon')">Ενότητα 2</button>
            <button onclick="navigate('home')">Επιστροφή</button>
        </div>

        <!-- Εισαγωγή Ενότητας 1 Ιστορίας -->
        <div id="history-unit1" style="display: none;">
            <h1>Εισαγωγή Ενότητας 1</h1>
            <p id="intro-text">
                <span class="sentence">Το ανεξάρτητο νεοελληνικό κράτος άρχισε την ιστορική του πορεία το 1830, μετά από μία δεκαετία σκληρών αγώνων, μεγάλων καταστροφών και ανθρώπινων απωλειών.</span>
                <span class="sentence">Η παγίωση της τάξης, της στοιχειώδους έστω κρατικής λειτουργίας και η αρχή της ανοικοδόμησης και της οικονομικής ανάπτυξης έχουν την αφετηρία τους στο 1833, μετά την εγκατάσταση της βαυαρικής δυναστείας στην Ελλάδα.</span>
                <span class="sentence">Το πρόβλημα που αντιμετώπιζε η χώρα δεν ήταν μόνο η αποκατάσταση των ζημιών που ο πολυετής πόλεμος και η αναρχία είχαν προκαλέσει.</span>
                <span class="sentence">Σχεδόν όλες οι δομές και οι λειτουργίες της κοινωνίας, στον οικονομικό ειδικά χώρο, ήταν απαρχαιωμένες και βρίσκονταν σε πλήρη αναντιστοιχία με τις προόδους που τα κράτη της Δυτικής Ευρώπης είχαν ήδη πετύχει στον τομέα αυτό.</span>
                <span class="sentence">Τα κράτη αυτά ζούσαν ήδη τη βιομηχανική επανάσταση και το μετασχηματισμό των παραγωγικών και οικονομικών τους δυνάμεων.</span>
                <span class="sentence">Η Ελλάδα βρισκόταν ακόμα στην Ανατολή, εκεί όπου η βιομηχανία ήταν άγνωστη, οι μεταφορές διεξάγονταν με πρωτόγονα μέσα και οι καλλιέργειες γίνονταν με μεθόδους οι οποίες ήταν γνωστές -οι περισσότερες- από την εποχή του Ησιόδου.</span>
            </p>
            <audio id="history-audio" src="ElevenLabs_2025-03-12T16_54_40_Rachel_pre_s50_sb75_se0_b_m2.mp3"></audio>
            <div class="audio-player">
                <button id="rewind-btn" onclick="rewindAudio()">⏪</button>
                <button id="play-pause-btn" onclick="playPauseAudio()">▶️</button>
                <button id="forward-btn" onclick="forwardAudio()">⏩</button>
            </div>
            <div class="progress-bar" onclick="seekAudio(event)">
                <div class="progress" id="progress-bar"></div>
            </div>
            <button onclick="navigate('history-menu')">Επιστροφή</button>
            <div id="time-indicator"></div>
        </div>

        <!-- Μενού Αγγλικών -->
        <div id="english-menu" style="display: none;">
            <h1>Αγγλικά</h1>
            <button onclick="startEnglishTest1()">Test 1</button>
            <button class="coming-soon-btn" onclick="navigate('coming-soon')">Test 2</button>
            <button onclick="navigate('home')">Επιστροφή</button>
        </div>
    </div>

    <script>
        const mathQuestions = [
            // ... (το υπάρχον array με τις ερωτήσεις των μαθηματικών παραμένει το ίδιο) ...
        ];

        const englishAdvertisements = `A) I am a 25-year-old nanny with 6 years experience in childcare with babies, toddlers and older children. I also worked with newborn babies in a hospital. I have checkable references, a childcare certificate, police check and a First Aid Certificate. I am a driver and non-smoker. I have lived in Berlin for more than 7 years; my English and Spanish are very good. I am looking for a live-in nanny job in Madrid from November. If you need a loving, caring, responsible person to look after your children and teach them English, please contact me by email or by phone.
B) Australian woman 32yrs, experienced PA, seeks job in Malaysia. Available end May. Bilingual in English and French. Partner: French. Work as a couple possible. Email: ...
C) Indian web publisher seeks work: Website design, desktop publishing, book layout, graphic design. Part time or contract. Experienced, skilled, reliable. Contact: ...
D) I have experience in banking, hotels, local government and manufacturing - all mostly working in administration type roles as well as vast experience with Microsoft packages, Sage and a range of other bespoke systems. I look forward to any replies or guidance...
E) Driving job needed - Highly skilled driver, over 25 - Have held full clean Class Cl licence for 10 years - Know London extremely well - Willing to do physical work such as loading trucks - Want full time work - Contact ...
F) Science and Maths lessons given. Experienced tutor, specialising in helping secondary school students with their state exams. Degree in Physics. Email ...`;

        const englishTest1Questions = [
            { text: "Question 1: Which person wants a teaching job?", options: ["A", "B", "C", "D", "E", "F"], answer: ["F"] },
            { text: "Question 2: Which two people mention their foreign language skills?", options: ["A", "B", "C", "D", "E", "F"], answer: ["A", "B"] },
            { text: "Question 3: Who would be willing to do part-time work?", options: ["A", "B", "C", "D", "E", "F"], answer: ["C"] },
            { text: "Question 4: Which two people describe their personal qualities?", options: ["A", "B", "C", "D", "E", "F"], answer: ["A", "C"] }
        ];

        let currentScreen = 'home';
        let currentQuestionIndex = 0;
        let score = 0;
        let timer;
        let timeLeft = 120;
        let shuffledQuestions = [];
        let totalQuestions = 0;
        let currentQuizType = 'math'; // 'math' or 'english'

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function navigate(screen) {
            const audio = document.getElementById('history-audio');
            if (audio && !audio.paused) {
                audio.pause();
                document.getElementById('play-pause-btn').textContent = '▶️';
            }
            document.querySelectorAll('.container > div').forEach(div => div.style.display = 'none');
            document.getElementById(screen === 'home' ? 'home-screen' : 
                                   screen === 'math' ? 'math-menu' : 
                                   screen === 'quiz-options' ? 'quiz-options' : 
                                   screen === 'units' ? 'units' : 
                                   screen === 'quiz' ? 'quiz-screen' : 
                                   screen === 'results' ? 'results-screen' : 
                                   screen === 'history' ? 'history-menu' : 
                                   screen === 'history-unit1' ? 'history-unit1' : 
                                   screen === 'english' ? 'english-menu' : 
                                   'coming-soon').style.display = 'block';
            currentScreen = screen;

            if (screen !== 'quiz') {
                clearInterval(timer);
            }
            if (screen === 'history-unit1') {
                setupAudioSync();
            }
        }

        function startRandomQuiz() {
            currentQuizType = 'math';
            shuffledQuestions = shuffleArray([...mathQuestions]).slice(0, 10);
            totalQuestions = 10;
            currentQuestionIndex = 0;
            score = 0;
            timeLeft = 120;
            navigate('quiz');
            document.getElementById('quiz-title').textContent = 'Σωστό / Λάθος';
            showQuestion();
            startTimer();
        }

        function startUnitQuiz(unit) {
            currentQuizType = 'math';
            if (unit === 'functions') {
                shuffledQuestions = shuffleArray(mathQuestions.slice(0, 25));
                totalQuestions = 25;
            } else if (unit === 'limits') {
                shuffledQuestions = shuffleArray(mathQuestions.slice(25, 51));
                totalQuestions = 26;
            } else if (unit === 'continuity') {
                shuffledQuestions = shuffleArray(mathQuestions.slice(51, 61));
                totalQuestions = 10;
            } else if (unit === 'derivatives') {
                shuffledQuestions = shuffleArray(mathQuestions.slice(61, 99));
                totalQuestions = 38;
            }
            currentQuestionIndex = 0;
            score = 0;
            timeLeft = 120;
            navigate('quiz');
            document.getElementById('quiz-title').textContent = 'Σωστό / Λάθος';
            showQuestion();
            startTimer();
        }

        function startEnglishTest1() {
            currentQuizType = 'english';
            shuffledQuestions = [...englishTest1Questions]; // No shuffle for fixed order
            totalQuestions = 4;
            currentQuestionIndex = 0;
            score = 0;
            timeLeft = 120;
            navigate('quiz');
            document.getElementById('quiz-title').textContent = 'English Test 1';
            showQuestion();
            startTimer();
        }

        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = `Χρόνος: ${timeLeft} δευτ.`;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    nextQuestion();
                }
            }, 1000);
        }

        function showQuestion() {
            const question = shuffledQuestions[currentQuestionIndex];
            document.getElementById('progress').textContent = `Ερώτηση ${currentQuestionIndex + 1}/${totalQuestions}`;
            document.getElementById('next-btn').style.display = 'none';
            const advertisementsDiv = document.getElementById('advertisements');
            const instructionsDiv = document.getElementById('instructions');
            const answerOptions = document.getElementById('answer-options');
            const submitBtn = document.getElementById('submit-btn');
            
            answerOptions.innerHTML = '';
            
            if (currentQuizType === 'math') {
                advertisementsDiv.style.display = 'none';
                instructionsDiv.style.display = 'none';
                document.getElementById('question').textContent = question.text;
                submitBtn.style.display = 'none';
                answerOptions.innerHTML = `
                    <button class="answer-btn" onclick="answer(true)">ΣΩΣΤΟ</button>
                    <button class="answer-btn" onclick="answer(false)">ΛΑΘΟΣ</button>
                `;
            } else if (currentQuizType === 'english') {
                advertisementsDiv.style.display = 'block';
                advertisementsDiv.textContent = englishAdvertisements;
                instructionsDiv.style.display = 'block';
                document.getElementById('question').textContent = question.text;
                submitBtn.style.display = 'block';
                question.options.forEach(option => {
                    const label = document.createElement('label');
                    label.innerHTML = `<input type="checkbox" name="answer" value="${option}"> ${option}`;
                    answerOptions.appendChild(label);
                });
            }
            
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('correct', 'wrong');
            });
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => {
                cb.checked = false;
                cb.disabled = false;
            });
        }

        function answer(userAnswer) {
            clearInterval(timer);
            const question = shuffledQuestions[currentQuestionIndex];
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => btn.disabled = true);

            if (userAnswer === question.answer) {
                buttons[userAnswer ? 0 : 1].classList.add('correct');
                score++;
            } else {
                buttons[userAnswer ? 0 : 1].classList.add('wrong');
                buttons[question.answer ? 0 : 1].classList.add('correct');
            }
            document.getElementById('next-btn').style.display = 'block';
        }

        function submitAnswer() {
            clearInterval(timer);
            const question = shuffledQuestions[currentQuestionIndex];
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const selectedAnswers = Array.from(checkboxes)
                .filter(cb => cb.checked)
                .map(cb => cb.value);
            const correctAnswers = question.answer;

            checkboxes.forEach(cb => {
                const label = cb.parentElement;
                cb.disabled = true;
                if (correctAnswers.includes(cb.value)) {
                    label.innerHTML += ' <span class="correct-tick">✓</span>'; // Προσθήκη πράσινου tick
                }
                if (selectedAnswers.includes(cb.value) && !correctAnswers.includes(cb.value)) {
                    label.classList.add('wrong-answer');
                }
            });

            const isCorrect = selectedAnswers.length === correctAnswers.length &&
                             selectedAnswers.every(ans => correctAnswers.includes(ans));
            if (isCorrect) score++;

            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('next-btn').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < totalQuestions) {
                timeLeft = 120;
                showQuestion();
                startTimer();
            } else {
                endQuiz();
            }
        }

        function endQuiz() {
            clearInterval(timer);
            navigate('results');
            document.getElementById('score').textContent = `Πέτυχες ${score}/${totalQuestions} απαντήσεις σωστά`;
            let feedback = '';
            const percentage = (score / totalQuestions) * 100;
            if (percentage >= 90) feedback = "Εξαιρετική επίδοση! Είσαι έτοιμος για τις εξετάσεις!";
            else if (percentage >= 70) feedback = "Πολύ καλά! Λίγη προσοχή ακόμα και είσαι έτοιμος!";
            else if (percentage >= 50) feedback = "Μπορείς καλύτερα! Δοκίμασε ξανά!";
            else feedback = "Χρειάζεται περισσότερη εξάσκηση! Ξαναδοκίμασε!";
            document.getElementById('feedback').textContent = feedback;

            // Αλλαγή: Ελέγχουμε τον τύπο του quiz και κατευθύνουμε σωστά τον χρήστη
            document.querySelector('#results-screen button:first-child').onclick = 
                currentQuizType === 'math' ? () => navigate('quiz-options') : 
                currentQuizType === 'english' ? () => navigate('english-menu') : null;
        }

        function playPauseAudio() {
            const audio = document.getElementById('history-audio');
            const playPauseBtn = document.getElementById('play-pause-btn');
            if (audio.paused) {
                audio.play();
                playPauseBtn.textContent = '⏸️';
            } else {
                audio.pause();
                playPauseBtn.textContent = '▶️';
            }
        }

        function rewindAudio() {
            const audio = document.getElementById('history-audio');
            audio.currentTime = Math.max(0, audio.currentTime - 15);
            highlightSentence(audio.currentTime);
            updateProgressBar();
            showTimeIndicator("Πήγε πίσω 15 δευτ.");
        }

        function forwardAudio() {
            const audio = document.getElementById('history-audio');
            audio.currentTime = Math.min(audio.duration, audio.currentTime + 15);
            highlightSentence(audio.currentTime);
            updateProgressBar();
            showTimeIndicator("Πήγε μπροστά 15 δευτ.");
        }

        function setupAudioSync() {
            const audio = document.getElementById('history-audio');
            const sentences = document.querySelectorAll('.sentence');
            const sentenceDuration = audio.duration / sentences.length;

            audio.ontimeupdate = () => {
                const currentTime = audio.currentTime;
                highlightSentence(currentTime, sentenceDuration);
                updateProgressBar();
            };

            audio.onended = () => {
                sentences.forEach(s => s.classList.remove('highlight'));
                document.getElementById('play-pause-btn').textContent = '▶️';
                updateProgressBar();
            };
        }

        function highlightSentence(currentTime, sentenceDuration = null) {
            const sentences = document.querySelectorAll('.sentence');
            const currentIndex = Math.floor(currentTime / (sentenceDuration || 10));
            
            sentences.forEach((sentence, index) => {
                if (index === currentIndex) {
                    sentence.classList.add('highlight');
                } else {
                    sentence.classList.remove('highlight');
                }
            });
        }

        function updateProgressBar() {
            const audio = document.getElementById('history-audio');
            const progress = document.getElementById('progress-bar');
            const percentage = (audio.currentTime / audio.duration) * 100;
            progress.style.width = `${percentage}%`;
        }

        function seekAudio(event) {
            const audio = document.getElementById('history-audio');
            const progressBar = document.querySelector('.progress-bar');
            const rect = progressBar.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const width = rect.width;
            const newTime = (clickX / width) * audio.duration;
            audio.currentTime = newTime;
            highlightSentence(newTime);
            updateProgressBar();
        }

        function showTimeIndicator(message) {
            const indicator = document.getElementById('time-indicator');
            indicator.textContent = message;
            indicator.style.display = 'block';
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 1500);
        }
    </script>
</body>
</html>
